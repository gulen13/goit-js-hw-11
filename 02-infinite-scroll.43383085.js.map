{"mappings":"iiBAAA,I,EAAAA,EAAAC,EAAA,S,iEAMMC,EAAeC,SAASC,cAAc,gBACtCC,EAAgBF,SAASC,cAAc,YAEvCE,EAAa,IAAI,EAAAC,EAAAC,YAEnBC,EAAW,IAAIC,EAAAC,GAAJ,CAAmB,aAAc,CAC9CC,aAAc,MACdC,aAAc,MAGVC,G,EAAqBJ,EAAAV,EAAA,CAAAU,EAAAK,GAAAC,MAAA,SAAAC,EAAMC,G,IAKzBC,EAUgEC,EAAtDC,EAAmBC,E,qEAdnCJ,EAAMK,iBACNjB,EAAWkB,YA2DXnB,EAAcoB,UAAY,GAxDpBN,EAAcD,EAAMQ,cAAcC,SAAsB,YAAEC,MAAMC,OAAOC,cAC7ExB,EAAWyB,MAAQZ,EAEC,KAAhBA,EAAkB,C,sBACpBjB,EAAa8B,QACbC,EAAAC,OAAOC,KAAK,8BAA+B,CAAEC,cAAc,I,oDAKe9B,EAAW+B,c,WAAjBjB,EAA8BkB,EAAAC,KAA1FlB,EAA4DD,EAA5DoB,KAAclB,EAA8CF,EAA9CqB,UAEL,IAFmDrB,EAApBsB,MAE9B,C,uBAChBT,EAAAC,OAAOS,QAAQ,2EAA4E,CAAEP,cAAc,I,2BAI7GH,EAAAC,OAAOU,QAAQ,oBAAkCC,OAAdvB,EAAc,YAAW,CAAEc,cAAc,KAE5E,EAAAU,EAAAC,oBAAmB1B,GAEnBZ,EAASuC,UAEL1B,EAAgBhB,EAAW2C,KAAO3C,EAAW4C,QAC/CC,OAAOC,oBAAoB,SAAUC,GAErCF,OAAOG,iBAAiB,SAAUD,G,kDAIpCE,QAAQC,IAAGlB,EAAAmB,I,mEAnCkBvC,G,iCAwC3BwC,EAAgB,W,MAAGhD,EAAAV,EAAA,CAAAU,EAAAK,GAAAC,MAAA,SAAAC,I,IAI+CG,EAAtDC,EAAmBC,E,yEAHnChB,EAAWqD,gB,kBAGiErD,EAAW+B,c,OAAjBjB,EAA8BkB,EAAAC,KAA1FlB,EAA4DD,EAA5DoB,KAAclB,EAA8CF,EAA9CqB,UAA8CrB,EAApBsB,OAEhD,EAAAI,EAAAC,oBAAmB1B,GAEnBZ,EAASuC,UAEL1B,EAAgBhB,EAAW2C,KAAO3C,EAAW4C,UAC/CjB,EAAAC,OAAOC,KAAK,6DAA8D,CAAEC,cAAc,IAC1Fe,OAAOC,oBAAoB,SAAUC,I,kDAIvCE,QAAQC,IAAGlB,EAAAmB,I,4GAhBO,GAwBtB,IAAMJ,EAAiB,WACAlD,SAASyD,gBAAgBC,wBAC7BC,OAAS3D,SAASyD,gBAAgBG,aAAe,KAChEL,G,EAIJxD,EAAaoD,iBAAiB,SAAUxC,GACxCqC,OAAOG,iBAAiB,SAAUD,E","sources":["src/partials/JS/02-infinite-scroll.js"],"sourcesContent":["import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport { PixabayAPI } from './pixabay-API';\nimport { createGalleryCards } from './createGallery';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst searchFormEl = document.querySelector('.search-form');\nconst galleryListEl = document.querySelector('.gallery');\n\nconst pixabayApi = new PixabayAPI();\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nconst onSearchFormSubmit = async event => {\n  event.preventDefault();\n  pixabayApi.pageReset();\n  clearMarkup();\n\n  const searchQuery = event.currentTarget.elements['searchQuery'].value.trim().toLowerCase();\n  pixabayApi.query = searchQuery;\n\n  if (searchQuery === '') {\n    searchFormEl.reset();\n    Notify.info('Please enter search request', { clickToClose: true, });\n    return;\n  }\n\n  try {\n    const { hits: images, totalHits: totalQuantity, total: quantity } = await pixabayApi.fetchPhotos();\n\n    if (quantity === 0) {\n      Notify.failure('Sorry, there are no images matching your search query. Please try again.', { clickToClose: true, });\n      return;\n    }\n\n    Notify.success(`Hooray! We found ${totalQuantity} images.`, { clickToClose: true, });\n\n    createGalleryCards(images);\n\n    lightbox.refresh();\n\n    if (totalQuantity < pixabayApi.page * pixabayApi.perPage) {\n      window.removeEventListener('scroll', infiniteScroll);\n    } else {\n      window.addEventListener('scroll', infiniteScroll);\n    }\n\n  } catch (error) {\n    console.log(error);\n  }\n\n};\n\nconst onInfiniteScroll = async () => {\n  pixabayApi.incrementPage();\n\n  try {\n    const { hits: images, totalHits: totalQuantity, total: quantity } = await pixabayApi.fetchPhotos();\n\n    createGalleryCards(images)\n\n    lightbox.refresh();\n\n    if (totalQuantity < pixabayApi.page * pixabayApi.perPage) {\n      Notify.info(\"We're sorry, but you've reached the end of search results.\", { clickToClose: true, });\n      window.removeEventListener('scroll', infiniteScroll);\n    }\n\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nfunction clearMarkup() {\n  galleryListEl.innerHTML = '';\n}\n\nconst infiniteScroll = () => {\n  const documentRect = document.documentElement.getBoundingClientRect();\n  if (documentRect.bottom < document.documentElement.clientHeight + 200) {\n    onInfiniteScroll();\n  };\n};\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nwindow.addEventListener('scroll', infiniteScroll);"],"names":["$bpxeT","parcelRequire","$3ebdb9d256d18adb$var$searchFormEl","document","querySelector","$3ebdb9d256d18adb$var$galleryListEl","$3ebdb9d256d18adb$var$pixabayApi","$9uO0Q","PixabayAPI","$3ebdb9d256d18adb$var$lightbox","$parcel$interopDefault","$5IjG7","captionsData","captionDelay","$3ebdb9d256d18adb$var$onSearchFormSubmit","$2TvXO","mark","_callee","event","searchQuery","ref","images","totalQuantity","preventDefault","pageReset","innerHTML","currentTarget","elements","value","trim","toLowerCase","query","reset","$h6c0i","Notify","info","clickToClose","fetchPhotos","_ctx","sent","hits","totalHits","total","failure","success","concat","$7g3w1","createGalleryCards","refresh","page","perPage","window","removeEventListener","$3ebdb9d256d18adb$var$infiniteScroll","addEventListener","console","log","t0","$3ebdb9d256d18adb$var$onInfiniteScroll","incrementPage","documentElement","getBoundingClientRect","bottom","clientHeight"],"version":3,"file":"02-infinite-scroll.43383085.js.map"}